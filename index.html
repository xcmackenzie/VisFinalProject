<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Project</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">
   <link rel="stylesheet" href="./style.css">

    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/d3/6.1.1/d3.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <script defer src="main.js" defer type="module"></script>
    <script defer src="LineChart.js" defer type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.18.2"></script>

</head>
<body>
    <div class="container">
        <div class = "title">
            <h1>
                Has BC Become More Diverse? <br><i style="font-size:35px">A look into the past 45 years</i>
            </h1>
           
        </div>        
        <div class = "viz-container">
           
            <h3>How has the distribution of ethnicities changed over time? How does this compare to the ethnic distribution of the country overall?</h3>
            <div class = "row ethnicity">
                <div class = "column">
                    <div id = "stacked-area"></div>
                </div>
                <div class = "column">
                    <div id = "dot-plot"></div>
                </div>
            </div>     
            <h3>What is the gender distribution of each school over time?</h3>
            <div class = "pie-chart">
                <div id = "school-pie-chart"></div>
            </div>
            <h3>How has the geographic distribution of students at BC changed over time?</h3>
            <div class = "row map">
                <div class = "column">
                    <p><strong>Number of Students from Each State in 1976</strong></p>
                    <div class = "map-1976"></div>
                </div>
                <div class = "column">
                    <p id = "state-name"><br>Alabama</p>
                    <p id = "state-info">
                        1976: 2<br>
                        1980: 1 <br>
                        1985: 3<br>
                        1990: 11<br>
                        1995: 13<br>
                        2000: 10<br>
                        2005: 10<br>
                        2010: 11<br>
                        2015: 7<br>
                        2020: 21
                    </p>
                </div>
                <div class = "column">
                    <p><strong>Number of Students from Each State in 2020</strong></p>
                    <div class = "map-2020"></div>
                </div>
            </div>
            <div class= "row enrollment">
                <div class = "bar-chart"></div>
                <div class = "area-chart"></div>
            </div>

            <h3>How Do BC's Demographics Compare to Peer Institutions?</h3>
            <div class = "row">
                <div class = "column">
                    <div id = "stacked-bar"></div>
                </div>
                <div class = "column">
                    <div id = "stacked-bar2"></div>
                </div>
        </div>
    </div>
    <div id ="map-tooltip" class = "hidden tooltip"></div>
    <div id = "state-line-tooltip" class = "hidden tooltip"></div>
    <div id="bar-tooltip" class="hidden tooltip">
    <div id="line-tooltip" class="hidden tooltip">
    <div id="area-tooltip" class="hidden tooltip">
    <div id="pie-tooltip" class="hidden tooltip">
    <div id="top-five-tooltip" class="hidden tooltip">
    <script>
        var stacked_area = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Number of Students of Each Ethnicity by Year",
            "data": {"url": "data/bcethnicity.csv"},
            "width": 350,
            "height": 250,
            "transform": [
                {"filter": "datum.Source == \"BC\""}
                ],
            "params": [{
                "name": "grid",
                "select": "interval",
                "bind": "scales"
            }],
            "mark": {"type": "area", "tooltip": true},
            "encoding": {
                "x": {
                    "field": "Year",
                    "title": "Year",
                    "type": "temporal"
                },
                "y": {
                    "field": "Total",
                    "title": "Total",
                    "type": "quantitative"
                },
                "color": {
                    "field": "Ethnicity",
                    "type": "nominal",
                    "scale": {"scheme": "set3"}
                },
                "tooltip": [
                    {
                        "field": "Ethnicity",
                        "type": "nominal"
                    },
                    {
                        "field": "Year",
                        "type": "temporal",
                        "timeUnit": "year",
                        "title": "Year"
                    },
                    {
                        "field": "Total",
                        "type": "quantitative"
                    },
                    {
                        "field": "Percent",
                        "type": "quantitative"
                    }
                ],
            }
        }

        var dot_plot = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Percentage of Students of Each Ethnicity at BC vs. in the US",
            "data": {"url": "data/bcethnicity.csv",
            "format": {
                "type": "csv",
                "parse": {
                "Year": "number"
                }
                }
            },
            "transform": [
                {"filter": "datum.Year == Yr_Year"}
            ],
            "width": 400,
            "height": 250,
            "encoding": {
                "x": {
                    "field": "Percent",
                    "type": "quantitative",
                    "title": "Percent"
                },
                "y": {
                    "field": "Ethnicity",
                    "type": "nominal",
                    "title": "Ethnicity",
                    "axis": {
                        "offset": 5,
                        "ticks": false,
                        "minExtent": 70,
                        "domain": false
                    }
                }
            },
            "layer": [
                {
                "mark": "line",
                "encoding": {
                    "detail": {
                    "field": "Ethnicity",
                    "type": "nominal"
                    },
                }
                },
                {
                "params": [{
                    "name": "Yr",
                    "select": {"type": "point", "fields": ["Year"]},
                    "bind": {
                    "Year": {
                        "input": "range",
                        "min": 1980,
                        "max": 2020,
                        "step": 10}
                    }
                }],
                "mark": {
                    "type": "point",
                    "filled": true,
                    "tooltip": true
                },
                "encoding": {
                    "color": {
                    "field": "Source",
                    "type": "ordinal",
                    "title": "Source",
                    "scale": {
                        "domain": ["BC", "US"],
                        "range": ["darkred", "grey"]
                    }
                    },
                    "size": {"value": 100},
                    "opacity": {"value": 1}
                    }
                }
            ]
        }
        vegaEmbed('#stacked-area', stacked_area);
        vegaEmbed('#dot-plot', dot_plot);

        var stacked_bar = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Gender Distribution at BC vs Peer Universities",
            "data": {"url": "data/otherschoolsgender.csv"},
            "width": 400,
            "height": 250,
            "layer": [
                {
            "mark": "bar",
                "encoding": {
                "x": {
                    "field": "School",
                    "type": "ordinal",
                    "title": "University"
                },
                "y": {
                    "aggregate": "sum",
                    "field": "Percent",
                    "type": "quantitative",
                    "title": "Percentage of Students"
                },
                "tooltip": [
                    {
                        "field": "Type",
                        "type": "nominal",
                        "title": "Gender"
                    },
                    {
                        "field": "Value",
                        "type": "quantitative",
                        "title": "Number of Students"
                    },
                    {
                        "field": "Percent",
                        "type": "quantitative",
                        "title": "Percent (%)"
                    }
                ],
                "color": {
                    "field": "Type",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Female", "Male"],
                        "range": ["#ffb6c1", "#aec7e8"]
                        }}
                }}
            ,
            {"mark": "rule",
            "encoding": {
                "y":  {"field": "Percent", "aggregate": "mean" },
                "size": {"value": 2},
                "color": {"value": "grey"},
                "strokeDash": {"signal": "strokeDash"}
            }}
        ]}
        vegaEmbed('#stacked-bar', stacked_bar);
    
        var stacked_bar2 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Ethnicities at BC vs Peer Universities",
            "data": {"url": "data/otherschoolsethnicity.csv"},
            "width": 400,
            "height": 250,
            "layer": [
                {
            "mark": "bar",
                "encoding": {
                "x": {
                    "field": "School",
                    "type": "ordinal",
                    "title": "University"
                },
                "y": {
                    "aggregate": "sum",
                    "field": "Percent",
                    "type": "quantitative"
                },
                "tooltip": [
                    {
                        "field": "Type",
                        "type": "nominal",
                        "title": "Ethnicity"
                    },
                    {
                        "field": "Value",
                        "type": "quantitative",
                        "title": "Number of Students"
                    },
                    {
                        "field": "Percent",
                        "type": "quantitative",
                        "title": "Percent (%)"
                    }
                ],
                "color": {
                    "field": "Type",
                    "type": "nominal",
                    "scale": {"scheme": "set3"}
                }}
        }]
    }

        vegaEmbed('#stacked-bar2', stacked_bar2);
    
    </script>
</body>
</html>
